WITH BART_CTE AS (
SELECT DISTINCT
BUDE.BEMSID,
BUDE.ESATS_ID,
BUBC.BEST_CODE,
--BU.HAS_REVERSE_PROXY,
--BU.HAS_SECURE_TOKEN
FROM 
boeing-dev-bcdap-scrr.SCRR_STG.BART_USER_DOMAIN_ESATSID BUDE
LEFT JOIN
boeing-dev-bcdap-scrr.SCRR_STG.BART_USER_BEST_CODES BUBC
ON 
BUDE.BEMSID = BUBC.BEMSID
AND BUDE.USERID = BUBC.USERID
--LEFT JOIN 
--SCRR_STG.BART_USER BU
--ON 
--BUDE.BEMSID = BU.BEMSID
--AND BUDE.USERID = BU.USERID
)

,CAIRO_SPLIT_DATA_TYPES AS (
  SELECT 
    ASSET_ID,
    TRIM(value) AS Information_Type
  FROM 
    `boeing-dev-bcdap-scrr.SCRR_STG.CAIRO_ACP_ROLE_RISK`,
    UNNEST(SPLIT(data_types, ',')) AS value
)
,CAIRO_CTE AS (
  SELECT 
    -- s.ASSET_ID,
  	irr.SUPPLIER_BEST_CODE,
    MAX(COALESCE(p.highest_level_confidentiality_control_code,0)) AS highest_level_confidentiality_control_code,
	STRING_AGG(DISTINCT s.Information_Type, ', ') AS distinct_Information_Type
  FROM 
    CAIRO_SPLIT_DATA_TYPES s
  LEFT JOIN 
    `boeing-dev-bcdap-scrr.SCRR_WORK.INFOSEC_POLICY` p
  ON 
    s.Information_Type = p.cairo_data_types
  LEFT JOIN
  BART_CTE as bc
  on
  s.ASSET_ID = bc.ESATS_ID
  LEFT JOIN
  boeing-dev-bcdap-scrr.SCRR_STG.IRR_STG_REPORT  as irr
  ON
  irr.SUPPLIER_BEST_CODE = bc.BEST_CODE
  GROUP BY 
    --s.ASSET_ID
  irr.SUPPLIER_BEST_CODE
),

BEDW_CTE AS (
 SELECT 
    REGEXP_REPLACE(OBJEK, '^00', 'BE') AS OBJEK,
    STRING_AGG(DISTINCT ATBEZ ORDER BY ATBEZ) AS ATBEZ_VALUES
FROM 
    boeing-dev-bcdap-scrr.SCRR_STG.BEDW_SAP_SP
GROUP BY 
    REGEXP_REPLACE(OBJEK, '^00', 'BE')

),

ESAFE_CTE AS (
SELECT 
-- esafe.BEMSID,
irr.SUPPLIER_BEST_CODE,
STRING_AGG(DISTINCT esafe.BADGE_TYPE ORDER BY esafe.BADGE_TYPE) AS BADGE_TYPE_VALUES
-- esafe.BADGE_TYPE
FROM 
boeing-dev-bcdap-scrr.SCRR_STG.BSB_BADGE_STATUS as esafe
LEFT JOIN
	BART_CTE as bc
ON
  bc.BEMSID = esafe.BEMSID  
LEFT JOIN 
boeing-dev-bcdap-scrr.SCRR_STG.IRR_STG_REPORT  as irr
  ON
  irr.SUPPLIER_BEST_CODE = bc.BEST_CODE
  group by irr.SUPPLIER_BEST_CODE),
  
  IRR_OUTPUT as (
  
select 

irr.SUPPLIER_BEST_CODE,
irr.DUNSNUMBER, 
irr.GLOBAL_ULTIMATE_DUNS_NUMBER,
sp.PARENT_ULTIMATE_DUNS_NUMBER,
irr.PARENT_BEST_SUPPLIER_ID, 
irr.SUPPLIER_NAME,
irr.BUSINESS_UNIT,
irr.ESATS_BA_MAX_AEC,
irr.ESATS_BA_MAX_AEC_NAME,
irr.BART_HAS_REVERSE_PROXY,
irr.BART_HAS_SECURE_TOKEN,
irr.BART_BA_USER_COUNT,
irr.CAIRO_HIGHEST_LEVEL_CONFIDENTIALITY_CONTROL_CODE,
cc.distinct_Information_Type as CAIRO_DISTINCT_INFORMATION_TYPE,
irr.BEDW_SP1_REPS_AND_CERTS,
bedw.ATBEZ_VALUES as BEDW_ATBEZ_VALUES,
irr.ESAFE_SECURE_BADGE_COUNT,
irr.ESAFE_SECURE_ACCESS_BADGE_COUNT,
esafe.BADGE_TYPE_VALUES as ESAFE_BADGE_TYPE_VALUES,
irr.SCRS_SUPPLIER_CRITICALITY_PRIORITY,
   NULL as Commodity,
   NULL as Contracts_PAs,
   NULL as Sum_of_SW_HW,
   NULL as Sum_of_SW_Dev,
irr.SOFTWARE_HARDWARE_RISK_SCORE,
irr.ACCESS_MANAGEMENT_RISK_SCORE,
irr.DATA_MANAGEMENT_RISK_SCORE,
irr.CYBER_COMPLIANCE_RISK_SCORE,
irr.PHYSICAL_SECURITY_RISK_SCORE,
irr.BUSINESS_RESILIENCE_RISK_SCORE,
irr.INHERENT_RISK_RATING_LOOKBACK_SCORE,
irr.IRR

from
boeing-dev-bcdap-scrr.SCRR_STG.IRR_STG_REPORT  as irr
LEFT JOIN
CAIRO_CTE as cc
ON 
irr.SUPPLIER_BEST_CODE = cc.SUPPLIER_BEST_CODE
LEFT JOIN
BEDW_CTE as bedw
ON
bedw.OBJEK = irr.SUPPLIER_BEST_CODE
LEFT JOIN 
ESAFE_CTE as esafe
ON 
esafe.SUPPLIER_BEST_CODE = irr.SUPPLIER_BEST_CODE
LEFT JOIN
`boeing-dev-bcdap-scrr.SCRR.DER_ACTIVE_SUPPLIER_PROFILE` AS sp
on
irr.SUPPLIER_BEST_CODE = sp.SUPPLIER_BEST_CODE),



COMMODITY_CTE as (
select 
DISTINCT
IRR_STG.SUPPLIER_BEST_CODE,
IBI.COMMODITY_CODE AS COMMODITY_CODE,
IBI.COMMODITY_DESCRIPTION as COMMODITY_CODE_DESC
from boeing-dev-bcdap-scrr.SCRR_STG.IRR_STG_REPORT as IRR_STG
left join
boeing-dev-bcdap-scrr.SCRR_STG.IBI_IBI_AI_PO_SCHED_V as IBI
ON
IRR_STG.SUPPLIER_BEST_CODE = IBI.BEST_CD
WHERE IBI.BEST_CD IS NOT NULL

UNION ALL

select 
DISTINCT
IRR_STG.SUPPLIER_BEST_CODE,
ISC.MATERIAL_GROUP_CODE AS COMMODITY_CODE,
ISC.MATERIAL_GROUP_DESC AS COMMODITY_CODE_DESC
from boeing-dev-bcdap-scrr.SCRR_STG.IRR_STG_REPORT as IRR_STG
left join
boeing-dev-bcdap-ariba.ARIBA.CV_P2P_PO_DOWNSTREAM_STG as ISC
ON
IRR_STG.SUPPLIER_BEST_CODE = REGEXP_REPLACE(ISC.BP_NUMBER, '^00', 'BE')
WHERE ISC.BP_NUMBER IS NOT NULL

UNION ALL

select 
DISTINCT
IRR_STG.SUPPLIER_BEST_CODE,
BEDW_BGSC.COMMODITY_CODE AS COMMODITY_CODE,
BEDW_BGSC.COMMODITY_CODE_DESC AS COMMODITY_CODE_DESC
from boeing-dev-bcdap-scrr.SCRR_STG.IRR_STG_REPORT as IRR_STG
left join
boeing-dev-bcdap-scrr.SCRR_STG.BEDW_BGSC_OPEN_PO BEDW_BGSC
ON
IRR_STG.SUPPLIER_BEST_CODE = BEDW_BGSC.BEST_CODE
WHERE BEDW_BGSC.BEST_CODE IS NOT NULL 

UNION ALL

select 
DISTINCT
IRR_STG.SUPPLIER_BEST_CODE,
SMMART.CATEGORY_L2 AS COMMODITY_CODE,
SMMART.CATEGORY_L1 as COMMODITY_CODE_DESC
from boeing-dev-bcdap-scrr.SCRR_STG.IRR_STG_REPORT as IRR_STG
left join
boeing-dev-bcdap-scrr.SCRR_STG.SMMART_BCA_COMMODITY_CODES as SMMART
ON
IRR_STG.SUPPLIER_BEST_CODE = SMMART.BEST_SUPPLIER_ID
WHERE SMMART.BEST_SUPPLIER_ID IS NOT NULL
),

TMP_COMMODITY_CTE as(
 select 
 COMMODITY_CTE.*
 , COMMODITY.SW_HW
 , COMMODITY.SW_DEV
from COMMODITY_CTE 
LEFT JOIN 
boeing-dev-bcdap-scrr.SCRR_STG.IRR_COMMODITY_CODE_TO_SW_HW_SW_DEV as COMMODITY
ON
COMMODITY_CTE.COMMODITY_CODE = COMMODITY.COMMODITY_CODE
AND COMMODITY_CTE.COMMODITY_CODE_DESC = COMMODITY.COMMODITY_CODE_DESC),

FINAL_COMMODITY_CTE AS (

SELECT
 SUPPLIER_BEST_CODE,
    STRING_AGG(DISTINCT COMMODITY_CODE, ',') AS COMMODITY_CODES,
    STRING_AGG(DISTINCT COMMODITY_CODE_DESC, ',') AS COMMODITY_CODES_DESC,
    IF(SUM(CAST(SW_HW AS INT64)) > 0, 1, 0) AS SW_HW,
    IF(SUM(CAST(SW_DEV AS INT64)) > 0, 1, 0) AS SW_DEV
 from TMP_COMMODITY_CTE
 group by 
SUPPLIER_BEST_CODE),

SOURCE_DATA AS (
select 

IRR_OUTPUT.SUPPLIER_BEST_CODE,
IRR_OUTPUT.DUNSNUMBER, 
IRR_OUTPUT.GLOBAL_ULTIMATE_DUNS_NUMBER,
IRR_OUTPUT.PARENT_ULTIMATE_DUNS_NUMBER,
IRR_OUTPUT.PARENT_BEST_SUPPLIER_ID, 
IRR_OUTPUT.SUPPLIER_NAME,
IRR_OUTPUT.BUSINESS_UNIT,
IRR_OUTPUT.ESATS_BA_MAX_AEC,
IRR_OUTPUT.ESATS_BA_MAX_AEC_NAME,
IRR_OUTPUT.BART_HAS_REVERSE_PROXY,
IRR_OUTPUT.BART_HAS_SECURE_TOKEN,
IRR_OUTPUT.BART_BA_USER_COUNT,
IRR_OUTPUT.CAIRO_HIGHEST_LEVEL_CONFIDENTIALITY_CONTROL_CODE,
-- IRR_OUTPUT.distinct_Information_Type as CAIRO_DISTINCT_INFORMATION_TYPE,
IRR_OUTPUT.CAIRO_DISTINCT_INFORMATION_TYPE,
IRR_OUTPUT.BEDW_SP1_REPS_AND_CERTS,
-- IRR_OUTPUT.ATBEZ_VALUES as BEDW_ATBEZ_VALUES,
IRR_OUTPUT.BEDW_ATBEZ_VALUES,
IRR_OUTPUT.ESAFE_SECURE_BADGE_COUNT,
IRR_OUTPUT.ESAFE_SECURE_ACCESS_BADGE_COUNT,
--IRR_OUTPUT.BADGE_TYPE_VALUES as ESAFE_BADGE_TYPE_VALUES,
IRR_OUTPUT.ESAFE_BADGE_TYPE_VALUES,
IRR_OUTPUT.SCRS_SUPPLIER_CRITICALITY_PRIORITY,
--   NULL as Commodity,
FINAL_COMMODITY_CTE.COMMODITY_CODES as Commodity,
FINAL_COMMODITY_CTE.COMMODITY_CODES_DESC as Commodity_Desc,
NULL as Contracts_PAs,
--   NULL as Sum_of_SW_HW,
--   NULL as Sum_of_SW_Dev,


FINAL_COMMODITY_CTE.SW_HW as Sum_of_SW_HW,
FINAL_COMMODITY_CTE.SW_DEV as Sum_of_SW_Dev,
-- IRR_OUTPUT.SOFTWARE_HARDWARE_RISK_SCORE,
CASE 
        WHEN COALESCE(FINAL_COMMODITY_CTE.SW_DEV, 0) > 0.1 THEN 5 / 5 * 0.3
        WHEN COALESCE(FINAL_COMMODITY_CTE.SW_HW, 0) > 0.1 THEN 3 / 5 * 0.3
        ELSE 0
    END AS SOFTWARE_HARDWARE_RISK_SCORE,
IRR_OUTPUT.ACCESS_MANAGEMENT_RISK_SCORE,
IRR_OUTPUT.DATA_MANAGEMENT_RISK_SCORE,
IRR_OUTPUT.CYBER_COMPLIANCE_RISK_SCORE,
IRR_OUTPUT.PHYSICAL_SECURITY_RISK_SCORE,
IRR_OUTPUT.BUSINESS_RESILIENCE_RISK_SCORE,
IRR_OUTPUT.INHERENT_RISK_RATING_LOOKBACK_SCORE,
IRR_OUTPUT.IRR,
CURRENT_TIMESTAMP() AS EVENT_TIMESTAMP,
CURRENT_TIMESTAMP() AS  PROCESS_TIMESTAMP,
CAST(NULL AS STRING) AS EVENT_COMMIT_NUMBER,
'INSERT' AS TRANSACTION_TYPE,
GENERATE_UUID() AS REPLICATION_ID,

TO_HEX(SHA256(TO_JSON_STRING(STRUCT(
IRR_OUTPUT.SUPPLIER_BEST_CODE,
IRR_OUTPUT.DUNSNUMBER, 
IRR_OUTPUT.GLOBAL_ULTIMATE_DUNS_NUMBER,
IRR_OUTPUT.PARENT_ULTIMATE_DUNS_NUMBER,
IRR_OUTPUT.PARENT_BEST_SUPPLIER_ID, 
IRR_OUTPUT.SUPPLIER_NAME,
IRR_OUTPUT.BUSINESS_UNIT,
IRR_OUTPUT.ESATS_BA_MAX_AEC,
IRR_OUTPUT.ESATS_BA_MAX_AEC_NAME,
IRR_OUTPUT.BART_HAS_REVERSE_PROXY,
IRR_OUTPUT.BART_HAS_SECURE_TOKEN,
IRR_OUTPUT.BART_BA_USER_COUNT,
IRR_OUTPUT.CAIRO_HIGHEST_LEVEL_CONFIDENTIALITY_CONTROL_CODE,
-- IRR_OUTPUT.distinct_Information_Type as CAIRO_DISTINCT_INFORMATION_TYPE,
IRR_OUTPUT.CAIRO_DISTINCT_INFORMATION_TYPE,
IRR_OUTPUT.BEDW_SP1_REPS_AND_CERTS,
-- IRR_OUTPUT.ATBEZ_VALUES as BEDW_ATBEZ_VALUES,
IRR_OUTPUT.BEDW_ATBEZ_VALUES,
IRR_OUTPUT.ESAFE_SECURE_BADGE_COUNT,
IRR_OUTPUT.ESAFE_SECURE_ACCESS_BADGE_COUNT,
--IRR_OUTPUT.BADGE_TYPE_VALUES as ESAFE_BADGE_TYPE_VALUES,
IRR_OUTPUT.ESAFE_BADGE_TYPE_VALUES,
IRR_OUTPUT.SCRS_SUPPLIER_CRITICALITY_PRIORITY,
--   NULL as Commodity,
FINAL_COMMODITY_CTE.COMMODITY_CODES as Commodity,
FINAL_COMMODITY_CTE.COMMODITY_CODES_DESC as Commodity_Desc,
NULL as Contracts_PAs,
--   NULL as Sum_of_SW_HW,
--   NULL as Sum_of_SW_Dev,


FINAL_COMMODITY_CTE.SW_HW as Sum_of_SW_HW,
FINAL_COMMODITY_CTE.SW_DEV as Sum_of_SW_Dev,
-- IRR_OUTPUT.SOFTWARE_HARDWARE_RISK_SCORE,
CASE 
        WHEN COALESCE(FINAL_COMMODITY_CTE.SW_DEV, 0) > 0.1 THEN 5 / 5 * 0.3
        WHEN COALESCE(FINAL_COMMODITY_CTE.SW_HW, 0) > 0.1 THEN 3 / 5 * 0.3
        ELSE 0
    END AS SOFTWARE_HARDWARE_RISK_SCORE,
IRR_OUTPUT.ACCESS_MANAGEMENT_RISK_SCORE,
IRR_OUTPUT.DATA_MANAGEMENT_RISK_SCORE,
IRR_OUTPUT.CYBER_COMPLIANCE_RISK_SCORE,
IRR_OUTPUT.PHYSICAL_SECURITY_RISK_SCORE,
IRR_OUTPUT.BUSINESS_RESILIENCE_RISK_SCORE,
IRR_OUTPUT.INHERENT_RISK_RATING_LOOKBACK_SCORE,
IRR_OUTPUT.IRR
)))) AS DATA_HASH

from
IRR_OUTPUT 
LEFT JOIN 
FINAL_COMMODITY_CTE
on
IRR_OUTPUT.SUPPLIER_BEST_CODE = FINAL_COMMODITY_CTE.SUPPLIER_BEST_CODE
)

MERGE `boeing-dev-bcdap-scrr.SCRR.DER_IRR_REPORT` T
USING SOURCE_DATA S
ON T.SUPPLIER_BEST_CODE = S.SUPPLIER_BEST_CODE
WHEN MATCHED AND T.DATA_HASH != S.DATA_HASH THEN
UPDATE SET

T.DUNSNUMBER = S.DUNSNUMBER
,T.GLOBAL_ULTIMATE_DUNS_NUMBER = S.GLOBAL_ULTIMATE_DUNS_NUMBER
,T.PARENT_ULTIMATE_DUNS_NUMBER    = S.PARENT_ULTIMATE_DUNS_NUMBER   
,T.PARENT_BEST_SUPPLIER_ID = S.PARENT_BEST_SUPPLIER_ID
,T.SUPPLIER_NAME = S.SUPPLIER_NAME
,T.BUSINESS_UNIT = S.BUSINESS_UNIT
,T.ESATS_BA_MAX_AEC = S.ESATS_BA_MAX_AEC
,T.ESATS_BA_MAX_AEC_NAME = S.ESATS_BA_MAX_AEC_NAME
,T.BART_HAS_REVERSE_PROXY = S.BART_HAS_REVERSE_PROXY
,T.BART_HAS_SECURE_TOKEN = S.BART_HAS_SECURE_TOKEN
,T.BART_BA_USER_COUNT = S.BART_BA_USER_COUNT
,T.CAIRO_HIGHEST_LEVEL_CONFIDENTIALITY_CONTROL_CODE = S.CAIRO_HIGHEST_LEVEL_CONFIDENTIALITY_CONTROL_CODE
,T.CAIRO_DISTINCT_INFORMATION_TYPE  = S.CAIRO_DISTINCT_INFORMATION_TYPE 
,T.BEDW_SP1_REPS_AND_CERTS = S.BEDW_SP1_REPS_AND_CERTS
,T.BEDW_ATBEZ_VALUES   = S.BEDW_ATBEZ_VALUES  
,T.ESAFE_SECURE_BADGE_COUNT = S.ESAFE_SECURE_BADGE_COUNT
,T.ESAFE_SECURE_ACCESS_BADGE_COUNT = S.ESAFE_SECURE_ACCESS_BADGE_COUNT
,T.ESAFE_BADGE_TYPE_VALUES   = S.ESAFE_BADGE_TYPE_VALUES  
,T.SCRS_SUPPLIER_CRITICALITY_PRIORITY = S.SCRS_SUPPLIER_CRITICALITY_PRIORITY
,T.Commodity = S.Commodity
,T.COMMODITY_CODES_DESC = S.COMMODITY_CODES_DESC
,T.Contracts_PAs = S.Contracts_PAs
,T.Sum_of_SW_HW = S.Sum_of_SW_HW
,T.Sum_of_SW_Dev = S.Sum_of_SW_Dev
,T.SOFTWARE_HARDWARE_RISK_SCORE = S.SOFTWARE_HARDWARE_RISK_SCORE
,T.ACCESS_MANAGEMENT_RISK_SCORE = S.ACCESS_MANAGEMENT_RISK_SCORE
,T.DATA_MANAGEMENT_RISK_SCORE = S.DATA_MANAGEMENT_RISK_SCORE
,T.CYBER_COMPLIANCE_RISK_SCORE = S.CYBER_COMPLIANCE_RISK_SCORE
,T.PHYSICAL_SECURITY_RISK_SCORE = S.PHYSICAL_SECURITY_RISK_SCORE
,T.BUSINESS_RESILIENCE_RISK_SCORE = S.BUSINESS_RESILIENCE_RISK_SCORE
,T.INHERENT_RISK_RATING_LOOKBACK_SCORE = S.INHERENT_RISK_RATING_LOOKBACK_SCORE
,T.IRR  = S.IRR 
--,T.EVENT_TIMESTAMP = S.EVENT_TIMESTAMP
--,T.PROCESS_TIMESTAMP = S.PROCESS_TIMESTAMP
--,T.EVENT_COMMIT_NUMBER = S.EVENT_COMMIT_NUMBER
--,T.TRANSACTION_TYPE = S.TRANSACTION_TYPE
--,T.REPLICATION_ID = S.REPLICATION_ID
,DATA_HASH = S.DATA_HASH
,updated_at = CURRENT_TIMESTAMP()
,updated_by = 'airflow DAG'         -- replace with parameter if available
,load_run_id = 'run_2025_11_05'

WHEN MATCHED AND T.DATA_HASH = S.DATA_HASH THEN
UPDATE SET
load_run_id = 'run_2025_11_05'
WHERE FALSE

WHEN NOT MATCHED BY TARGET THEN
INSERT (
SUPPLIER_BEST_CODE
 ,DUNSNUMBER
  ,GLOBAL_ULTIMATE_DUNS_NUMBER
  ,PARENT_ULTIMATE_DUNS_NUMBER   
  ,PARENT_BEST_SUPPLIER_ID
  ,SUPPLIER_NAME
  ,BUSINESS_UNIT
  ,ESATS_BA_MAX_AEC
  ,ESATS_BA_MAX_AEC_NAME
  ,BART_HAS_REVERSE_PROXY
  ,BART_HAS_SECURE_TOKEN
  ,BART_BA_USER_COUNT
  ,CAIRO_HIGHEST_LEVEL_CONFIDENTIALITY_CONTROL_CODE
  ,CAIRO_DISTINCT_INFORMATION_TYPE 
  ,BEDW_SP1_REPS_AND_CERTS
  ,BEDW_ATBEZ_VALUES  
  ,ESAFE_SECURE_BADGE_COUNT
  ,ESAFE_SECURE_ACCESS_BADGE_COUNT
  ,ESAFE_BADGE_TYPE_VALUES  
  ,SCRS_SUPPLIER_CRITICALITY_PRIORITY
  ,Commodity
  ,COMMODITY_CODES_DESC
  ,Contracts_PAs
  ,Sum_of_SW_HW
  ,Sum_of_SW_Dev
  ,SOFTWARE_HARDWARE_RISK_SCORE
  ,ACCESS_MANAGEMENT_RISK_SCORE
  ,DATA_MANAGEMENT_RISK_SCORE
  ,CYBER_COMPLIANCE_RISK_SCORE
  ,PHYSICAL_SECURITY_RISK_SCORE
  ,BUSINESS_RESILIENCE_RISK_SCORE
  ,INHERENT_RISK_RATING_LOOKBACK_SCORE
  ,IRR 
  ,EVENT_TIMESTAMP
  ,PROCESS_TIMESTAMP
  ,EVENT_COMMIT_NUMBER
  ,TRANSACTION_TYPE
  ,REPLICATION_ID
  
  ,data_hash
  ,created_at
  ,updated_at
  ,load_run_id
  ,is_deleted
)
VALUES (
SUPPLIER_BEST_CODE
 ,S.DUNSNUMBER
  ,S.GLOBAL_ULTIMATE_DUNS_NUMBER
  ,S.PARENT_ULTIMATE_DUNS_NUMBER   
  ,S.PARENT_BEST_SUPPLIER_ID
  ,S.SUPPLIER_NAME
  ,S.BUSINESS_UNIT
  ,S.ESATS_BA_MAX_AEC
  ,S.ESATS_BA_MAX_AEC_NAME
  ,S.BART_HAS_REVERSE_PROXY
  ,S.BART_HAS_SECURE_TOKEN
  ,S.BART_BA_USER_COUNT
  ,S.CAIRO_HIGHEST_LEVEL_CONFIDENTIALITY_CONTROL_CODE
  ,S.CAIRO_DISTINCT_INFORMATION_TYPE 
  ,S.BEDW_SP1_REPS_AND_CERTS
  ,S.BEDW_ATBEZ_VALUES  
  ,S.ESAFE_SECURE_BADGE_COUNT
  ,S.ESAFE_SECURE_ACCESS_BADGE_COUNT
  ,S.ESAFE_BADGE_TYPE_VALUES  
  ,S.SCRS_SUPPLIER_CRITICALITY_PRIORITY
  ,S.Commodity
  ,S.COMMODITY_CODES_DESC
  ,S.Contracts_PAs
  ,S.Sum_of_SW_HW
  ,S.Sum_of_SW_Dev
  ,S.SOFTWARE_HARDWARE_RISK_SCORE
  ,S.ACCESS_MANAGEMENT_RISK_SCORE
  ,S.DATA_MANAGEMENT_RISK_SCORE
  ,S.CYBER_COMPLIANCE_RISK_SCORE
  ,S.PHYSICAL_SECURITY_RISK_SCORE
  ,S.BUSINESS_RESILIENCE_RISK_SCORE
  ,S.INHERENT_RISK_RATING_LOOKBACK_SCORE
  ,S.IRR 
  ,S.EVENT_TIMESTAMP
  ,S.PROCESS_TIMESTAMP
  ,S.EVENT_COMMIT_NUMBER
  ,S.TRANSACTION_TYPE
  ,S.REPLICATION_ID
  ,S.data_hash
  
    ,CURRENT_TIMESTAMP()
  ,CURRENT_TIMESTAMP()
  ,'run_2025_11_05'
  ,FALSE
)
